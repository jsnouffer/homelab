atm9:
  enabled: true

  nameOverride: atm9

  minecraftServer:
    eula: "true"
    difficulty: normal
    type: AUTO_CURSEFORGE
    memory: 10240M
    onlineMode: true
    motd: All The Mods 9

    autoCurseForge:
      pageUrl: https://www.curseforge.com/minecraft/modpacks/all-the-mods-9/files/4885522
      apiKey:
          existingSecret: curseforge-api-key
          secretKey: key
    rcon:
      enabled: true
      existingSecret: minecraft-admin-password
      secretKey: password

  mcbackup:
    enabled: true
    initialDelay: 10m
    backupMethod: restic
    rconRetries: -1
    rconRetryInterval: 30s
    resticRepository: s3:http://barenas.jsnouff.net:9000/atm9-backups
    extraEnv:
      RESTIC_PASSWORD:
        valueFrom:
          secretKeyRef:
            name: restic-backup-credentials
            key: resticKey
      AWS_ACCESS_KEY_ID:
        valueFrom:
          secretKeyRef:
            name: restic-backup-credentials
            key: s3AccessKey
      AWS_SECRET_ACCESS_KEY:
        valueFrom:
          secretKeyRef:
            name: restic-backup-credentials
            key: s3SecretKey

  initContainers:
    - name: manual-mod-downloads
      image: bash
      command: ["bash"]
      args:
        - -c
        - /scripts/download-mods.sh /mods
      volumeMounts:
        - name: datadir
          mountPath: /mods
          subPath: mods
        - name: manual-mod-downloads-atm9
          mountPath: /scripts

  extraVolumes:
    - volumes:
        - name: manual-mod-downloads-atm9
          configMap:
            name: manual-mod-downloads-atm9
            defaultMode: 0777

  startupProbe:
    enabled: true
    failureThreshold: 50
    periodSeconds: 20

  resources:
    requests:
      memory: 10Gi
      cpu: 1500m
    limits:
      memory: 16Gi
      cpu: 2500m

  persistence:
    dataDir:
      enabled: true
      Size: 6Gi

manualModDownloads:
  atm9:
    - https://mediafilez.forgecdn.net/files/4709/710/industrial-foregoing-1.20.1-3.5.9.jar
    - https://mediafilez.forgecdn.net/files/4614/446/findme-3.1.0-forge.jar
    - https://mediafilez.forgecdn.net/files/4767/394/Structory_1.20.2_v1.3.3.jar
    - https://mediafilez.forgecdn.net/files/4810/615/functionalstorage-1.20.1-1.2.5.jar
    - https://mediafilez.forgecdn.net/files/4810/679/titanium-1.20.1-3.8.23.jar
    - https://mediafilez.forgecdn.net/files/4862/132/rsrequestify-1.20.1-2.3.3.jar
    - https://mediafilez.forgecdn.net/files/4645/933/DarkModeEverywhere-1.20.1-1.2.2.jar
    - https://mediafilez.forgecdn.net/files/4881/868/allthewizardgear-1.20.1-1.0.8.jar
    - https://mediafilez.forgecdn.net/files/4763/645/entityculling-forge-1.6.2-mc1.20.1.jar
    - https://mediafilez.forgecdn.net/files/4802/113/totw_modded-1.0.2-1.20.1.jar
